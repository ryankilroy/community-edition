---
#@ load("@ytt:data", "data")
#@ load("@ytt:yaml", "yaml")

# kpack-service-account uses registry-credentials and tells kpack where it can
# store images during the build process, including the final deployable image.
apiVersion: v1
kind: Secret
metadata:
  name: registry-credentials
  annotations:
    kpack.io/docker: #@ data.values.kpack.registry.url
type: kubernetes.io/basic-auth
stringData:
  username: #@ data.values.kpack.registry.username
  password: #@ data.values.kpack.registry.password

---
apiVersion: v1  # Developer namespace
kind: ServiceAccount
metadata:
  name: workload-user-sa
  namespace: default
secrets:
- name: registry-credentials
imagePullSecrets:
- name: registry-credentials